syntax = "proto3";

package storage;

option go_package = "github.com/Nikita-Smirnov-idk/Antiplagiat_System/services/storage_service/gen/go;storagepb";

// Service for storing files
service Storage {
  // Get upload url RPC
  rpc GenerateUploadURL(GenerateUploadURLRequest) returns (GenerateUploadURLResponse) {}

  // Verify uploaded file RPC
  rpc VerifyUploadedFile(VerifyUploadedFileRequest) returns (VerifyUploadedFileResponse) {}

  // Get download url RPC
  rpc GenerateDownloadURL(GenerateDownloadURLRequest) returns (GenerateDownloadURLResponse) {}

  // Get students ids by task id (those who participated)
  rpc GetStudentsByTaskId(GetStudentsByTaskIdRequest) returns (GetStudentsByTaskIdResponse) {}
}

// Request for url to upload file
message GenerateUploadURLRequest {
  string StudentId = 1;
  string TaskId = 2;
}

// Response after generating upload link
message GenerateUploadURLResponse {
  string Url = 1;
}

// Request for verifying uploaded file
message VerifyUploadedFileRequest {
  string StudentId = 1;
  string TaskId = 2;
}

// Response after verifying uploaded file
message VerifyUploadedFileResponse {
  string FileId = 1;
}

// Request for url to download file
message GenerateDownloadURLRequest {
  string StudentId = 1;
  string TaskId = 2;
}

// Response after generating download link
message GenerateDownloadURLResponse {
  string Url = 1;
}

message GetStudentsByTaskIdRequest {
  string TaskId = 1;
}

message GetStudentsByTaskIdResponse {
  repeated string student_ids = 1;
}
